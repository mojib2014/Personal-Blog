{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"prefixCls\"];\nimport React, { useContext, useEffect } from 'react';\nimport { EditorContext } from '../../Context';\nimport { TextAreaCommandOrchestrator } from '../../commands';\nimport handleKeyDown from './handleKeyDown';\nimport shortcuts from './shortcuts';\nimport \"./index.css\";\nexport default function Textarea(props) {\n  var prefixCls = props.prefixCls,\n      other = _objectWithoutProperties(props, _excluded);\n\n  var _useContext = useContext(EditorContext),\n      markdown = _useContext.markdown,\n      commands = _useContext.commands,\n      fullscreen = _useContext.fullscreen,\n      preview = _useContext.preview,\n      highlightEnable = _useContext.highlightEnable,\n      extraCommands = _useContext.extraCommands,\n      tabSize = _useContext.tabSize,\n      _onChange = _useContext.onChange,\n      dispatch = _useContext.dispatch;\n\n  var textRef = React.useRef(null);\n  var executeRef = React.useRef();\n  var statesRef = React.useRef({\n    fullscreen: fullscreen,\n    preview: preview\n  });\n  useEffect(function () {\n    statesRef.current = {\n      fullscreen: fullscreen,\n      preview: preview,\n      highlightEnable: highlightEnable\n    };\n  }, [fullscreen, preview, highlightEnable]);\n  useEffect(function () {\n    if (textRef.current && dispatch) {\n      var commandOrchestrator = new TextAreaCommandOrchestrator(textRef.current);\n      executeRef.current = commandOrchestrator;\n      dispatch({\n        textarea: textRef.current,\n        commandOrchestrator: commandOrchestrator\n      });\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, []);\n\n  var onKeyDown = function onKeyDown(e) {\n    handleKeyDown(e, tabSize);\n    shortcuts(e, [].concat(_toConsumableArray(commands || []), _toConsumableArray(extraCommands || [])), executeRef.current, dispatch, statesRef.current);\n  };\n\n  useEffect(function () {\n    if (textRef.current) {\n      textRef.current.addEventListener('keydown', onKeyDown);\n    }\n\n    return function () {\n      if (textRef.current) {\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        textRef.current.removeEventListener('keydown', onKeyDown);\n      }\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return /*#__PURE__*/React.createElement(\"textarea\", _extends({\n    autoComplete: \"off\",\n    autoCorrect: \"off\",\n    autoCapitalize: \"off\",\n    spellCheck: false\n  }, other, {\n    ref: textRef,\n    className: \"\".concat(prefixCls, \"-text-input \").concat(other.className ? other.className : ''),\n    value: markdown,\n    onChange: function onChange(e) {\n      dispatch && dispatch({\n        markdown: e.target.value\n      });\n      _onChange && _onChange(e.target.value);\n    }\n  }));\n}","map":{"version":3,"sources":["../../../../src/components/TextArea/Textarea.tsx"],"names":["prefixCls","other","props","markdown","commands","fullscreen","preview","highlightEnable","extraCommands","tabSize","onChange","dispatch","useContext","textRef","React","executeRef","statesRef","useEffect","commandOrchestrator","textarea","onKeyDown","handleKeyDown","shortcuts","e","value"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect } from 'react';\nimport { IProps } from '../../utils';\nimport { EditorContext, ExecuteCommandState } from '../../Context';\nimport { TextAreaCommandOrchestrator } from '../../commands';\nimport handleKeyDown from './handleKeyDown';\nimport shortcuts from './shortcuts';\nimport './index.less';\n\nexport interface TextAreaProps extends Omit<React.TextareaHTMLAttributes<HTMLTextAreaElement>, 'value'>, IProps {}\n\nexport default function Textarea(props: TextAreaProps) {\n  const { prefixCls, ...other } = props;\n  const { markdown, commands, fullscreen, preview, highlightEnable, extraCommands, tabSize, onChange, dispatch } =\n    useContext(EditorContext);\n  const textRef = React.useRef<HTMLTextAreaElement>(null);\n  const executeRef = React.useRef<TextAreaCommandOrchestrator>();\n  const statesRef = React.useRef<ExecuteCommandState>({ fullscreen, preview });\n\n  useEffect(() => {\n    statesRef.current = { fullscreen, preview, highlightEnable };\n  }, [fullscreen, preview, highlightEnable]);\n\n  useEffect(() => {\n    if (textRef.current && dispatch) {\n      const commandOrchestrator = new TextAreaCommandOrchestrator(textRef.current);\n      executeRef.current = commandOrchestrator;\n      dispatch({ textarea: textRef.current, commandOrchestrator });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const onKeyDown = (e: KeyboardEvent | React.KeyboardEvent<HTMLTextAreaElement>) => {\n    handleKeyDown(e, tabSize);\n    shortcuts(e, [...(commands || []), ...(extraCommands || [])], executeRef.current, dispatch, statesRef.current);\n  };\n  useEffect(() => {\n    if (textRef.current) {\n      textRef.current.addEventListener('keydown', onKeyDown);\n    }\n    return () => {\n      if (textRef.current) {\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        textRef.current.removeEventListener('keydown', onKeyDown);\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <textarea\n      autoComplete=\"off\"\n      autoCorrect=\"off\"\n      autoCapitalize=\"off\"\n      spellCheck={false}\n      {...other}\n      ref={textRef}\n      className={`${prefixCls}-text-input ${other.className ? other.className : ''}`}\n      value={markdown}\n      onChange={(e) => {\n        dispatch && dispatch({ markdown: e.target.value });\n        onChange && onChange(e.target.value);\n      }}\n    />\n  );\n}\n"]},"metadata":{},"sourceType":"module"}