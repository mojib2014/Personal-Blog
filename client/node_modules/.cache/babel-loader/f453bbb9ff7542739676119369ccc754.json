{"ast":null,"code":"var _jsxFileName = \"/Users/mojib2014/Desktop/projects/node_projects/blog/client/src/Blog/showpost.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport axios from \"axios\";\nimport history from \"../utils/history\";\nimport Context from \"../utils/context\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Button from \"@material-ui/core/Button\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ShowPost = props => {\n  _s();\n\n  const context = useContext(Context);\n  const [stateLocal, setState] = useState({\n    comment: \"\",\n    fetched: false,\n    cid: 0,\n    delete_comment_id: 0,\n    edit_comment_id: 0,\n    edit_comment: \"\",\n    comments_arr: null,\n    cur_user_id: null,\n    like_post: true,\n    likes: 0,\n    like_user_ids: [],\n    post_title: null,\n    post_body: null,\n    post_author: null,\n    post_id: null\n  });\n  useEffect(() => {\n    if (props.location.state && !stateLocal.fetched) {\n      console.log(\"tttt\");\n      setState({ ...stateLocal,\n        fetched: true,\n        likes: props.location.state.post.post.likes,\n        like_user_ids: props.location.state.post.post.like_user_id,\n        post_title: props.location.state.post.post.title,\n        post_body: props.location.state.post.post.body,\n        post_author: props.location.state.post.post.author,\n        post_id: props.location.state.post.post.pid\n      });\n    }\n  }, [stateLocal, props.location]);\n  useEffect(() => {\n    if (!props.location.state && !stateLocal.fetched) {\n      console.log(\"yyyy\");\n      const post_id = props.location.pathname.substring(6);\n      axios.get(\"/api/get/post\", {\n        params: {\n          post_id: post_id\n        }\n      }).then(res => res.data.length !== 0 ? setState({ ...stateLocal,\n        fetched: true,\n        likes: res.data[0].likes,\n        like_user_ids: res.data[0].like_user_id,\n        post_title: res.data[0].title,\n        post_body: res.data[0].body,\n        post_author: res.data[0].author,\n        post_id: res.data[0].pid\n      }) : null).catch(err => console.log(err));\n    }\n  }, [stateLocal, props.location]);\n  useEffect(() => {\n    if (!stateLocal.comments_arr) {\n      if (props.location.state) {\n        const post_id = props.location.pathname.substring(6);\n        axios.get(\"/api/get/allpostcomments\", {\n          params: {\n            post_id: post_id\n          }\n        }).then(res => res.data.length !== 0 ? setState({ ...stateLocal,\n          comments_arr: [...res.data]\n        }) : null).catch(err => console.log(err));\n      }\n    }\n  }, [props.location, stateLocal]);\n\n  const handleCommentSubmit = submitted_comment => {\n    if (stateLocal.comments_arr) {\n      setState({ ...stateLocal,\n        comments_arr: [submitted_comment, ...stateLocal.comments_arr]\n      });\n    } else {\n      setState({ ...stateLocal,\n        comments_arr: [submitted_comment]\n      });\n    }\n  };\n\n  const handleCommentUpdate = comment => {\n    const commentIndex = stateLocal.comments_arr.findIndex(com => com.cid === comment.cid);\n    var newArr = [...stateLocal.comments_arr];\n    newArr[commentIndex] = comment;\n    setTimeout(() => setState({ ...stateLocal,\n      comments_arr: [...newArr],\n      edit_comment_id: 0\n    }), 100);\n  };\n\n  const handleCommentDelete = cid => {\n    setState({ ...stateLocal,\n      delete_comment_id: cid\n    });\n    const newArr = stateLocal.comments_arr.filter(com => com.cid !== cid);\n    setState({ ...stateLocal,\n      comments_arr: newArr\n    });\n  };\n\n  const handleEditFormClose = () => {\n    setState({ ...stateLocal,\n      edit_comment_id: 0\n    });\n  };\n\n  const RenderComments = props => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: stateLocal.delete_comment_id === props.comment.cid ? \"FadeOutComment\" : \"CommentStyles\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [props.comment.comment, \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n          children: props.comment.date_created === \"Just Now\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\" \", props.comment.isEdited ? /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \" Edited \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \" Just Now \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 15\n          }, this) : props.comment.date_created\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\" By: \", props.comment.author, \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: props.cur_user_id === props.comment.user_id ? !props.isEditing ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => setState({ ...stateLocal,\n              edit_comment_id: props.comment.cid,\n              edit_comment: props.comment.comment\n            }),\n            children: \"Edit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: (event, cid) => handleUpdate(event, props.comment.cid),\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            autoFocus: true,\n            name: \"edit_comment\",\n            id: \"editted_comment\",\n            label: \"Comment\",\n            value: stateLocal.edit_comment,\n            onChange: handleEditCommentChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\",\n            children: \"Agree\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            type: \"button\",\n            onClick: handleEditFormClose,\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleDeleteComment(props.comment.cid),\n            children: \"Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 15\n        }, this) : null\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this);\n  };\n\n  const handleEditCommentChange = event => setState({ ...stateLocal,\n    edit_comment: event.target.value\n  });\n\n  const handleSubmit = event => {\n    event.preventDefault();\n    setState({ ...stateLocal,\n      comment: \"\"\n    });\n    const comment = event.target.comment.value;\n    const user_id = context.dbProfileState[0].uid;\n    const username = context.dbProfileState[0].username;\n    const post_id = stateLocal.post_id;\n    const current_time = \"Just Now\";\n    const temp_cid = Math.floor(Math.random() * 1000);\n    const submitted_comment = {\n      cid: temp_cid,\n      comment: comment,\n      user_id: user_id,\n      author: username,\n      date_created: current_time\n    };\n    const data = {\n      comment: event.target.comment.value,\n      post_id: post_id,\n      user_id: user_id,\n      username: username\n    };\n    axios.post(\"/api/post/commenttodb\", data).then(res => console.log(res)).catch(err => console.log(err));\n    window.scroll({\n      top: 0,\n      left: 0,\n      behavior: \"smooth\"\n    });\n    handleCommentSubmit(submitted_comment);\n  };\n\n  const handleUpdate = (event, cid) => {\n    event.preventDefault();\n    console.log(event);\n    console.log(cid);\n    const comment = event.target.editted_comment.value;\n    const comment_id = cid;\n    const post_id = stateLocal.post_id;\n    const user_id = context.dbProfileState[0].uid;\n    const username = context.dbProfileState[0].username;\n    const isEdited = true;\n    const current_time = \"Just Now\";\n    const edited_comment = {\n      cid: comment_id,\n      comment: comment,\n      user_id: user_id,\n      author: username,\n      date_created: current_time,\n      isEdited: isEdited\n    };\n    const data = {\n      cid: comment_id,\n      comment: comment,\n      post_id: post_id,\n      user_id: user_id,\n      username: username\n    };\n    axios.put(\"/api/put/commenttodb\", data).then(res => console.log(res)).catch(err => console.log(err));\n    handleCommentUpdate(edited_comment);\n  };\n\n  const handleDeleteComment = cid => {\n    const comment_id = cid;\n    console.log(cid);\n    axios.delete(\"/api/delete/comment\", {\n      data: {\n        comment_id: comment_id\n      }\n    }).then(res => console.log(res)).catch(err => console.log(err));\n    handleCommentDelete(cid);\n  };\n\n  const handleLikes = () => {\n    const user_id = context.dbProfileState[0].uid;\n    const post_id = stateLocal.post_id;\n    const data = {\n      uid: user_id,\n      post_id: post_id\n    };\n    console.log(data);\n\n    if (!stateLocal.like_user_ids.includes(user_id)) {\n      axios.put(\"/api/put/likes\", data).then(!stateLocal.like_user_ids.includes(user_id) && stateLocal.like_post ? setState({ ...stateLocal,\n        likes: stateLocal.likes + 1,\n        like_post: false\n      }) : null).catch(err => console.log(err));\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Post\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 9\n      }, this), stateLocal.comments_arr || props.location.state ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: stateLocal.post_title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: stateLocal.post_body\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: stateLocal.post_author\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 11\n      }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          cursor: \"pointer\"\n        },\n        onClick: context.authState ? () => handleLikes() : () => history.replace(\"/signup\"),\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"material-icons\",\n          children: \"thumb_up\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n          className: \"notification-num-showpost\",\n          children: stateLocal.likes\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \" Comments:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 9\n      }, this), stateLocal.comments_arr ? stateLocal.comments_arr.map(comment => /*#__PURE__*/_jsxDEV(RenderComments, {\n        comment: comment,\n        cur_user_id: context.dbProfileState ? context.dbProfileState[0].uid : null,\n        isEditing: comment.cid === stateLocal.edit_comment_id ? true : false\n      }, comment.cid, false, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 15\n      }, this)) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(TextField, {\n          id: \"comment\",\n          label: \"Comment\",\n          margin: \"normal\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: console.log(\"hhhhh\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 354,\n          columnNumber: 11\n        }, this), context.authState ? /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          color: \"primary\",\n          type: \"submit\",\n          children: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/signup\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            color: \"primary\",\n            children: \"Signup to Comment\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 308,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ShowPost, \"fclpUGVmPSZhMiQwGgkyYGV2LQE=\");\n\n_c = ShowPost;\nexport default ShowPost;\n\nvar _c;\n\n$RefreshReg$(_c, \"ShowPost\");","map":{"version":3,"sources":["/Users/mojib2014/Desktop/projects/node_projects/blog/client/src/Blog/showpost.js"],"names":["React","useContext","useState","useEffect","Link","axios","history","Context","TextField","Button","ShowPost","props","context","stateLocal","setState","comment","fetched","cid","delete_comment_id","edit_comment_id","edit_comment","comments_arr","cur_user_id","like_post","likes","like_user_ids","post_title","post_body","post_author","post_id","location","state","console","log","post","like_user_id","title","body","author","pid","pathname","substring","get","params","then","res","data","length","catch","err","handleCommentSubmit","submitted_comment","handleCommentUpdate","commentIndex","findIndex","com","newArr","setTimeout","handleCommentDelete","filter","handleEditFormClose","RenderComments","date_created","isEdited","user_id","isEditing","event","handleUpdate","handleEditCommentChange","handleDeleteComment","target","value","handleSubmit","preventDefault","dbProfileState","uid","username","current_time","temp_cid","Math","floor","random","window","scroll","top","left","behavior","editted_comment","comment_id","edited_comment","put","delete","handleLikes","includes","cursor","authState","replace","map"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect } from \"react\";\n\nimport { Link } from \"react-router-dom\";\nimport axios from \"axios\";\nimport history from \"../utils/history\";\nimport Context from \"../utils/context\";\n\nimport TextField from \"@material-ui/core/TextField\";\n\nimport Button from \"@material-ui/core/Button\";\n\nconst ShowPost = (props) => {\n  const context = useContext(Context);\n\n  const [stateLocal, setState] = useState({\n    comment: \"\",\n    fetched: false,\n    cid: 0,\n    delete_comment_id: 0,\n    edit_comment_id: 0,\n    edit_comment: \"\",\n    comments_arr: null,\n    cur_user_id: null,\n    like_post: true,\n    likes: 0,\n    like_user_ids: [],\n    post_title: null,\n    post_body: null,\n    post_author: null,\n    post_id: null,\n  });\n\n  useEffect(() => {\n    if (props.location.state && !stateLocal.fetched) {\n      console.log(\"tttt\");\n      setState({\n        ...stateLocal,\n        fetched: true,\n        likes: props.location.state.post.post.likes,\n        like_user_ids: props.location.state.post.post.like_user_id,\n        post_title: props.location.state.post.post.title,\n        post_body: props.location.state.post.post.body,\n        post_author: props.location.state.post.post.author,\n        post_id: props.location.state.post.post.pid,\n      });\n    }\n  }, [stateLocal, props.location]);\n\n  useEffect(() => {\n    if (!props.location.state && !stateLocal.fetched) {\n      console.log(\"yyyy\");\n      const post_id = props.location.pathname.substring(6);\n\n      axios\n        .get(\"/api/get/post\", { params: { post_id: post_id } })\n        .then((res) =>\n          res.data.length !== 0\n            ? setState({\n                ...stateLocal,\n                fetched: true,\n                likes: res.data[0].likes,\n                like_user_ids: res.data[0].like_user_id,\n                post_title: res.data[0].title,\n                post_body: res.data[0].body,\n                post_author: res.data[0].author,\n                post_id: res.data[0].pid,\n              })\n            : null,\n        )\n        .catch((err) => console.log(err));\n    }\n  }, [stateLocal, props.location]);\n\n  useEffect(() => {\n    if (!stateLocal.comments_arr) {\n      if (props.location.state) {\n        const post_id = props.location.pathname.substring(6);\n        axios\n          .get(\"/api/get/allpostcomments\", { params: { post_id: post_id } })\n          .then((res) =>\n            res.data.length !== 0\n              ? setState({ ...stateLocal, comments_arr: [...res.data] })\n              : null,\n          )\n          .catch((err) => console.log(err));\n      }\n    }\n  }, [props.location, stateLocal]);\n\n  const handleCommentSubmit = (submitted_comment) => {\n    if (stateLocal.comments_arr) {\n      setState({\n        ...stateLocal,\n        comments_arr: [submitted_comment, ...stateLocal.comments_arr],\n      });\n    } else {\n      setState({ ...stateLocal, comments_arr: [submitted_comment] });\n    }\n  };\n\n  const handleCommentUpdate = (comment) => {\n    const commentIndex = stateLocal.comments_arr.findIndex(\n      (com) => com.cid === comment.cid,\n    );\n    var newArr = [...stateLocal.comments_arr];\n    newArr[commentIndex] = comment;\n\n    setTimeout(\n      () =>\n        setState({\n          ...stateLocal,\n          comments_arr: [...newArr],\n          edit_comment_id: 0,\n        }),\n      100,\n    );\n  };\n\n  const handleCommentDelete = (cid) => {\n    setState({ ...stateLocal, delete_comment_id: cid });\n    const newArr = stateLocal.comments_arr.filter((com) => com.cid !== cid);\n    setState({ ...stateLocal, comments_arr: newArr });\n  };\n\n  const handleEditFormClose = () => {\n    setState({ ...stateLocal, edit_comment_id: 0 });\n  };\n\n  const RenderComments = (props) => {\n    return (\n      <div\n        className={\n          stateLocal.delete_comment_id === props.comment.cid\n            ? \"FadeOutComment\"\n            : \"CommentStyles\"\n        }\n      >\n        <div>\n          <p>{props.comment.comment} </p>\n          <small>\n            {props.comment.date_created === \"Just Now\" ? (\n              <div>\n                {\" \"}\n                {props.comment.isEdited ? (\n                  <span> Edited </span>\n                ) : (\n                  <span> Just Now </span>\n                )}\n              </div>\n            ) : (\n              props.comment.date_created\n            )}\n          </small>\n          <p> By: {props.comment.author} </p>\n        </div>\n        <div>\n          {props.cur_user_id === props.comment.user_id ? (\n            !props.isEditing ? (\n              <div>\n                <Button\n                  onClick={() =>\n                    setState({\n                      ...stateLocal,\n                      edit_comment_id: props.comment.cid,\n                      edit_comment: props.comment.comment,\n                    })\n                  }\n                >\n                  Edit\n                </Button>\n              </div>\n            ) : (\n              <form\n                onSubmit={(event, cid) =>\n                  handleUpdate(event, props.comment.cid)\n                }\n              >\n                <input\n                  autoFocus={true}\n                  name=\"edit_comment\"\n                  id=\"editted_comment\"\n                  label=\"Comment\"\n                  value={stateLocal.edit_comment}\n                  onChange={handleEditCommentChange}\n                />\n                <br />\n                <Button type=\"submit\">Agree</Button>\n                <Button type=\"button\" onClick={handleEditFormClose}>\n                  Cancel\n                </Button>\n                <button onClick={() => handleDeleteComment(props.comment.cid)}>\n                  Delete\n                </button>\n              </form>\n            )\n          ) : null}\n        </div>\n      </div>\n    );\n  };\n\n  const handleEditCommentChange = (event) =>\n    setState({ ...stateLocal, edit_comment: event.target.value });\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    setState({ ...stateLocal, comment: \"\" });\n\n    const comment = event.target.comment.value;\n    const user_id = context.dbProfileState[0].uid;\n    const username = context.dbProfileState[0].username;\n    const post_id = stateLocal.post_id;\n    const current_time = \"Just Now\";\n    const temp_cid = Math.floor(Math.random() * 1000);\n\n    const submitted_comment = {\n      cid: temp_cid,\n      comment: comment,\n      user_id: user_id,\n      author: username,\n      date_created: current_time,\n    };\n\n    const data = {\n      comment: event.target.comment.value,\n      post_id: post_id,\n      user_id: user_id,\n      username: username,\n    };\n\n    axios\n      .post(\"/api/post/commenttodb\", data)\n      .then((res) => console.log(res))\n      .catch((err) => console.log(err));\n    window.scroll({ top: 0, left: 0, behavior: \"smooth\" });\n    handleCommentSubmit(submitted_comment);\n  };\n\n  const handleUpdate = (event, cid) => {\n    event.preventDefault();\n    console.log(event);\n    console.log(cid);\n    const comment = event.target.editted_comment.value;\n    const comment_id = cid;\n    const post_id = stateLocal.post_id;\n    const user_id = context.dbProfileState[0].uid;\n    const username = context.dbProfileState[0].username;\n    const isEdited = true;\n    const current_time = \"Just Now\";\n\n    const edited_comment = {\n      cid: comment_id,\n      comment: comment,\n      user_id: user_id,\n      author: username,\n      date_created: current_time,\n      isEdited: isEdited,\n    };\n\n    const data = {\n      cid: comment_id,\n      comment: comment,\n      post_id: post_id,\n      user_id: user_id,\n      username: username,\n    };\n\n    axios\n      .put(\"/api/put/commenttodb\", data)\n      .then((res) => console.log(res))\n      .catch((err) => console.log(err));\n    handleCommentUpdate(edited_comment);\n  };\n\n  const handleDeleteComment = (cid) => {\n    const comment_id = cid;\n    console.log(cid);\n    axios\n      .delete(\"/api/delete/comment\", { data: { comment_id: comment_id } })\n      .then((res) => console.log(res))\n      .catch((err) => console.log(err));\n    handleCommentDelete(cid);\n  };\n\n  const handleLikes = () => {\n    const user_id = context.dbProfileState[0].uid;\n    const post_id = stateLocal.post_id;\n\n    const data = { uid: user_id, post_id: post_id };\n    console.log(data);\n    if (!stateLocal.like_user_ids.includes(user_id)) {\n      axios\n        .put(\"/api/put/likes\", data)\n        .then(\n          !stateLocal.like_user_ids.includes(user_id) && stateLocal.like_post\n            ? setState({\n                ...stateLocal,\n                likes: stateLocal.likes + 1,\n                like_post: false,\n              })\n            : null,\n        )\n        .catch((err) => console.log(err));\n    }\n  };\n\n  return (\n    <div>\n      <div>\n        <h2>Post</h2>\n        {stateLocal.comments_arr || props.location.state ? (\n          <div>\n            <p>{stateLocal.post_title}</p>\n            <p>{stateLocal.post_body}</p>\n            <p>{stateLocal.post_author}</p>\n          </div>\n        ) : null}\n\n        <div\n          style={{ cursor: \"pointer\" }}\n          onClick={\n            context.authState\n              ? () => handleLikes()\n              : () => history.replace(\"/signup\")\n          }\n        >\n          <i className=\"material-icons\">thumb_up</i>\n          <small className=\"notification-num-showpost\">\n            {stateLocal.likes}\n          </small>\n        </div>\n      </div>\n      <div>\n        <h2> Comments:</h2>\n        {stateLocal.comments_arr\n          ? stateLocal.comments_arr.map((comment) => (\n              <RenderComments\n                comment={comment}\n                cur_user_id={\n                  context.dbProfileState ? context.dbProfileState[0].uid : null\n                }\n                key={comment.cid}\n                isEditing={\n                  comment.cid === stateLocal.edit_comment_id ? true : false\n                }\n              />\n            ))\n          : null}\n      </div>\n      <div>\n        <form onSubmit={handleSubmit}>\n          <TextField id=\"comment\" label=\"Comment\" margin=\"normal\" />\n          <br />\n          <div>{console.log(\"hhhhh\")}</div>\n          {context.authState ? (\n            <Button variant=\"contained\" color=\"primary\" type=\"submit\">\n              Submit\n            </Button>\n          ) : (\n            <Link to=\"/signup\">\n              <Button variant=\"contained\" color=\"primary\">\n                Signup to Comment\n              </Button>\n            </Link>\n          )}\n        </form>\n      </div>\n      <div></div>\n    </div>\n  );\n};\n\nexport default ShowPost;\n"]},"metadata":{},"sourceType":"module"}